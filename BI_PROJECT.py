# -*- coding: utf-8 -*-
"""
Created on Thu Dec  9 13:49:41 2021

@author: shrutika_shelke
"""

import pymysql
import petl as etl
 
#Extracting data from csv
table1 = etl.fromcsv(r"C:\ProgramData\MySQL\MySQL Server 8.0\Uploads\Project_BI.csv")
print("table1 ")
print(table1)

#Transformation 
#coverting brand name 'addidas' to 'ADDIDAS'
print("Maintaining uniformity transforming addidas to ADDIDAS")
table2= etl.convert(table1,'Brand_name', 'replace','addidas','ADDIDAS')
print(table2)
print("\n")

#converting profit(int) to float
print("Converting Profit to Float")
table3= etl.convert(table1,'Profit', float)
print(table3)
print("\n")

#coverting State 'Gujarat' to 'Delhi'
print("Maintaining uniformity transforming Gujarat to Delhi")
table4= etl.convert(table1,'State', 'replace','Gujarat','Delhi')
print(table4)
print("\n")

#converting Purchase int'594097' to string 'Medium'
print("Converting int into string")
table5= etl.convert(table1,'Purchase', 'replace','594097','Medium')
print(table5)
print("\n")

#Transforming all product_type to UpperCase
print("Transforming all product_type to UpperCase")
table6= etl.convert(table1,'Product_type', 'upper')
print(table6 ['Product_type'])
print("\n")

#Establishing connection with Mysql
connection =pymysql.connect(host='localhost',user='root',password='root123',database='Project_BI1')

#printing table 'brand'
print("printing brand table")
table1= etl.fromdb(connection,'select *from brand')
print(table1)
print("\n")

#brand year wise sales in covid
print("brand yearwise sales")
table2=etl.fromdb(connection,'select sum(sale),brand_id from fact_table',)
print(table2)
print("\n")
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































